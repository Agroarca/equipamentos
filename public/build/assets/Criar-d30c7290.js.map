{"version":3,"file":"Criar-d30c7290.js","sources":["../../../resources/js/Pages/Admin/Equipamentos/Cadastro/Equipamento/Criar.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { useForm } from '@inertiajs/vue3'\nimport { watch, computed, onMounted, ref } from 'vue'\nimport axios from 'axios'\nimport AdminLayout from '@/Layouts/AdminLayout.vue'\nimport FormError from '@/Componentes/Layout/Forms/FormError.vue'\nimport Mask from '@/Componentes/Helper/InputMask'\nimport SelectAjax from '@/Componentes/Layout/Forms/SelectAjax.vue'\n\nconst props = defineProps({\n    categorias: Object,\n})\n\nconst elValor = ref(null)\n\nlet marca\nlet modelo\n\nconst placeholderModelo = computed(() => (form.marca_id ? 'Selecione um Modelo' : 'Selecione uma marca'))\n\nonMounted(() => {\n    Mask.preco(elValor.value)\n})\n\nconst form = useForm({\n    titulo: '',\n    valor: '',\n    ano: '',\n    marca_id: '',\n    modelo_id: '',\n    categoria_id: '',\n})\n\nwatch(() => form.marca_id, (newValue, oldValue) => {\n    if (newValue !== oldValue) {\n        form.modelo_id = ''\n    }\n})\n\nasync function submit() {\n    loader.show()\n    if (!form.marca_id) {\n        await salvarMarca()\n    }\n\n    if (!form.modelo_id) {\n        await salvarModelo()\n    }\n\n    form.post('/admin/equipamentos/salvar', { onFinish: () => loader.hide() })\n}\n\nfunction criarNovaMarca(search) {\n    marca = search\n}\n\nfunction criarNovoModelo(search) {\n    modelo = search\n}\n\nasync function salvarMarca() {\n    let response = await axios.post('/admin/marcas/salvar/ajax', {\n        nome: marca,\n    })\n\n    form.marca_id = response.data.id\n}\n\nasync function salvarModelo() {\n    let response = await axios.post('/admin/modelos/salvar/ajax', {\n        nome: modelo,\n        marca_id: form.marca_id,\n    })\n\n    form.modelo_id = response.data.id\n}\n\n</script>\n\n<template>\n    <AdminLayout titulo=\"Novo Equipamento\">\n        <form @submit.prevent=\"submit\">\n            <div class=\"card card-default\">\n                <div class=\"card-body\">\n                    <div class=\"mb-3\">\n                        <label for=\"titulo\">TÃ­tulo</label>\n                        <input id=\"titulo\" v-model=\"form.titulo\" class=\"form-control\" type=\"text\" required>\n                        <FormError :error=\"form.errors.titulo\" />\n                    </div>\n                    <div class=\"mb-3\">\n                        <label for=\"valor\">Valor</label>\n                        <input id=\"valor\" ref=\"elValor\" v-model=\"form.valor\" class=\"form-control\" type=\"text\" required>\n                        <FormError :error=\"form.errors.valor\" />\n                    </div>\n                    <div class=\"mb-3\">\n                        <label for=\"ano\">Ano</label>\n                        <input id=\"ano\" v-model=\"form.ano\" class=\"form-control\" type=\"text\" required>\n                        <FormError :error=\"form.errors.ano\" />\n                    </div>\n                    <div class=\"mb-3\">\n                        <label for=\"marca_id\">Marca</label>\n                        <SelectAjax\n                            v-model=\"form.marca_id\"\n                            placeholder=\"Selecione uma marca\"\n                            href=\"/admin/marcas/pesquisar\"\n                            :preBusca=\"true\"\n                            :criarDinamica=\"true\"\n                            @criarNovaOpcao=\"criarNovaMarca\" />\n                        <FormError :error=\"form.errors.modelo_id\" />\n                    </div>\n                    <div class=\"mb-3\">\n                        <label for=\"marca_id\">Modelo</label>\n                        <SelectAjax\n                            v-model=\"form.modelo_id\"\n                            :disabled=\"!(form.marca_id || marca)\"\n                            :placeholder=\"placeholderModelo\"\n                            :href=\"form.marca_id ? `/admin/modelos/pesquisar/${form.marca_id}` : null\"\n                            :preBusca=\"true\"\n                            :criarDinamica=\"true\"\n                            @criarNovaOpcao=\"criarNovoModelo\" />\n                        <FormError :error=\"form.errors.modelo_id\" />\n                    </div>\n                    <div class=\"mb-3\">\n                        <label for=\"categoria_id\">Categoria</label>\n                        <select id=\"categoria_id\" v-model=\"form.categoria_id\" class=\"form-select\" required>\n                            <option v-for=\"(categoria, index) in categorias\" :key=\"index\" :value=\"index\">\n                                {{ categoria }}\n                            </option>\n                        </select>\n                        <FormError :error=\"form.errors.categoria_id\" />\n                    </div>\n                </div>\n                <div class=\"card-footer\">\n                    <button type=\"submit\" class=\"btn btn-primary\">\n                        Criar\n                    </button>\n                </div>\n            </div>\n        </form>\n    </AdminLayout>\n</template>\n"],"names":["useForm"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAaM,UAAA,UAAU,IAAI,IAAI;AAEpB,QAAA;AACA,QAAA;AAEJ,UAAM,oBAAoB,SAAS,MAAO,KAAK,WAAW,wBAAwB,qBAAsB;AAExG,cAAU,MAAM;AACP,WAAA,MAAM,QAAQ,KAAK;AAAA,IAAA,CAC3B;AAED,UAAM,OAAOA,EAAQ;AAAA,MACjB,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,KAAK;AAAA,MACL,UAAU;AAAA,MACV,WAAW;AAAA,MACX,cAAc;AAAA,IAAA,CACjB;AAED,UAAM,MAAM,KAAK,UAAU,CAAC,UAAU,aAAa;AAC/C,UAAI,aAAa,UAAU;AACvB,aAAK,YAAY;AAAA,MACrB;AAAA,IAAA,CACH;AAED,mBAAe,SAAS;AACpB,aAAO,KAAK;AACR,UAAA,CAAC,KAAK,UAAU;AAChB,cAAM,YAAY;AAAA,MACtB;AAEI,UAAA,CAAC,KAAK,WAAW;AACjB,cAAM,aAAa;AAAA,MACvB;AAEK,WAAA,KAAK,8BAA8B,EAAE,UAAU,MAAM,OAAO,QAAQ;AAAA,IAC7E;AAEA,aAAS,eAAe,QAAQ;AACpB,cAAA;AAAA,IACZ;AAEA,aAAS,gBAAgB,QAAQ;AACpB,eAAA;AAAA,IACb;AAEA,mBAAe,cAAc;AACzB,UAAI,WAAW,MAAM,MAAM,KAAK,6BAA6B;AAAA,QACzD,MAAM;AAAA,MAAA,CACT;AAEI,WAAA,WAAW,SAAS,KAAK;AAAA,IAClC;AAEA,mBAAe,eAAe;AAC1B,UAAI,WAAW,MAAM,MAAM,KAAK,8BAA8B;AAAA,QAC1D,MAAM;AAAA,QACN,UAAU,KAAK;AAAA,MAAA,CAClB;AAEI,WAAA,YAAY,SAAS,KAAK;AAAA,IACnC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}