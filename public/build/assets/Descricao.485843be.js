import{E as Ut,o as _t,h as Zt,b as $e,f as Qt,e as Xt}from"./app.c01ba62c.js";function yt(r,e,t){for(let n=0;;n++){if(n==r.childCount||n==e.childCount)return r.childCount==e.childCount?null:t;let i=r.child(n),s=e.child(n);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=yt(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function wt(r,e,t,n){for(let i=r.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:n};let o=r.child(--i),l=e.child(--s),a=o.nodeSize;if(o==l){t-=a,n-=a;continue}if(!o.sameMarkup(l))return{a:t,b:n};if(o.isText&&o.text!=l.text){let c=0,u=Math.min(o.text.length,l.text.length);for(;c<u&&o.text[o.text.length-c-1]==l.text[l.text.length-c-1];)c++,t--,n--;return{a:t,b:n}}if(o.content.size||l.content.size){let c=wt(o.content,l.content,t-1,n-1);if(c)return c}t-=a,n-=a}}class g{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,i=0,s){for(let o=0,l=0;l<t;o++){let a=this.content[o],c=l+a.nodeSize;if(c>e&&n(a,i+l,s||null,o)!==!1&&a.content.size){let u=l+1;a.nodesBetween(Math.max(0,e-u),Math.min(a.content.size,t-u),n,i+u)}l=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,i){let s="",o=!0;return this.nodesBetween(e,t,(l,a)=>{l.isText?(s+=l.text.slice(Math.max(e,a)-a,t-a),o=!n):l.isLeaf?(i?s+=typeof i=="function"?i(l):i:l.type.spec.leafText&&(s+=l.type.spec.leafText(l)),o=!n):!o&&l.isBlock&&(s+=n,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(n)&&(i[i.length-1]=t.withText(t.text+n.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new g(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let n=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let l=this.content[s],a=o+l.nodeSize;a>e&&((o<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,t-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,t-o-1))),n.push(l),i+=l.nodeSize),o=a}return new g(n,i)}cutByIndex(e,t){return e==t?g.empty:e==0&&t==this.content.length?this:new g(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-n.nodeSize;return i[e]=t,new g(i,s)}addToStart(e){return new g([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new g(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let i=this.content[t];e(i,n,t),n+=i.nodeSize}}findDiffStart(e,t=0){return yt(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return wt(this,e,t,n)}findIndex(e,t=-1){if(e==0)return ue(0,e);if(e==this.size)return ue(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let s=this.child(n),o=i+s.nodeSize;if(o>=e)return o==e||t>0?ue(n+1,o):ue(n,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return g.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new g(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return g.empty;let t,n=0;for(let i=0;i<e.length;i++){let s=e[i];n+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new g(t||e,n)}static from(e){if(!e)return g.empty;if(e instanceof g)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new g([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}g.empty=new g([],0);const Ce={index:0,offset:0};function ue(r,e){return Ce.index=r,Ce.offset=e,Ce}function De(r,e){if(r===e)return!0;if(!(r&&typeof r=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(r);if(Array.isArray(e)!=t)return!1;if(t){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!De(r[n],e[n]))return!1}else{for(let n in r)if(!(n in e)||!De(r[n],e[n]))return!1;for(let n in e)if(!(n in r))return!1}return!0}class O{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!n&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),n=!0),t&&t.push(s)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&De(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);return n.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return O.none;if(e instanceof O)return[e];let t=e.slice();return t.sort((n,i)=>n.type.rank-i.type.rank),t}}O.none=[];class Yt extends Error{}class y{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=xt(this.content,e+this.openStart,t);return n&&new y(n,this.openStart,this.openEnd)}removeBetween(e,t){return new y(kt(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return y.empty;let n=t.openStart||0,i=t.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new y(g.fromJSON(e,t.content),n,i)}static maxOpen(e,t=!0){let n=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new y(e,n,i)}}y.empty=new y(g.empty,0,0);function kt(r,e,t){let{index:n,offset:i}=r.findIndex(e),s=r.maybeChild(n),{index:o,offset:l}=r.findIndex(t);if(i==e||s.isText){if(l!=t&&!r.child(o).isText)throw new RangeError("Removing non-flat range");return r.cut(0,e).append(r.cut(t))}if(n!=o)throw new RangeError("Removing non-flat range");return r.replaceChild(n,s.copy(kt(s.content,e-i-1,t-i-1)))}function xt(r,e,t,n){let{index:i,offset:s}=r.findIndex(e),o=r.maybeChild(i);if(s==e||o.isText)return n&&!n.canReplace(i,i,t)?null:r.cut(0,e).append(t).append(r.cut(e));let l=xt(o.content,e-s-1,t);return l&&r.replaceChild(i,o.copy(l))}class Je{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}class ge{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(n=>{n.tag?this.tags.push(n):n.style&&this.styles.push(n)}),this.normalizeLists=!this.tags.some(n=>{if(!/^(ul|ol)\b/.test(n.tag)||!n.node)return!1;let i=e.nodes[n.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let n=new et(this,t,!1);return n.addAll(e,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new et(this,t,!0);return n.addAll(e,t.from,t.to),y.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(nn(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,n,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!n.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(o.getAttrs){let a=o.getAttrs(t);if(a===!1)continue;o.attrs=a||void 0}return o}}}static schemaRules(e){let t=[];function n(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let l=t[o];if((l.priority==null?50:l.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{n(o=tt(o)),o.mark=i})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{n(o=tt(o)),o.node=i})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ge(e,ge.schemaRules(e)))}}const St={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},en={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Mt={ol:!0,ul:!0},ye=1,we=2,ne=4;function Ye(r,e,t){return e!=null?(e?ye:0)|(e==="full"?we:0):r&&r.whitespace=="pre"?ye|we:t&~ne}class fe{constructor(e,t,n,i,s,o,l){this.type=e,this.attrs=t,this.marks=n,this.pendingMarks=i,this.solid=s,this.options=l,this.content=[],this.activeMarks=O.none,this.stashMarks=[],this.match=o||(l&ne?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(g.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ye)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=g.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(g.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,n=this.pendingMarks;t<n.length;t++){let i=n[t];(this.type?this.type.allowsMarkType(i.type):sn(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!St.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class et{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0;let i=t.topNode,s,o=Ye(null,t.preserveWhitespace,0)|(n?ne:0);i?s=new fe(i.type,i.attrs,O.none,O.none,!0,t.topMatch||i.type.contentMatch,o):n?s=new fe(null,null,O.none,O.none,!0,null,o):s=new fe(e.schema.topNodeType,null,O.none,O.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){if(e.nodeType==3)this.addTextNode(e);else if(e.nodeType==1){let t=e.getAttribute("style"),n=t?this.readStyles(rn(t)):null,i=this.top;if(n!=null)for(let s=0;s<n.length;s++)this.addPendingMark(n[s]);if(this.addElement(e),n!=null)for(let s=0;s<n.length;s++)this.removePendingMark(n[s],i)}}addTextNode(e){let t=e.nodeValue,n=this.top;if(n.options&we||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(n.options&ye)n.options&we?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=n.content[n.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let n=e.nodeName.toLowerCase(),i;Mt.hasOwnProperty(n)&&this.parser.normalizeLists&&tn(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(s?s.ignore:en.hasOwnProperty(n))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,l=this.top,a=this.needsBlock;if(St.hasOwnProperty(n))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),o=!0,l.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}this.addAll(e),o&&this.sync(l),this.needsBlock=a}else this.addElementByRule(e,s,s.consuming===!1?i:void 0)}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=O.none;e:for(let n=0;n<e.length;n+=2)for(let i=void 0;;){let s=this.parser.matchStyle(e[n],e[n+1],this,i);if(!s)continue e;if(s.ignore)return null;if(t=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(t),s.consuming===!1)i=s;else break}return t}addElementByRule(e,t,n){let i,s,o;t.node?(s=this.parser.schema.nodes[t.node],s.isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):i=this.enter(s,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a)}i&&this.sync(l)&&this.open--,o&&this.removePendingMark(o,l)}addAll(e,t,n){let i=t||0;for(let s=t?e.childNodes[t]:e.firstChild,o=n==null?null:e.childNodes[n];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let t,n;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,n=s,!o.length)||s.solid)break}if(!t)return!1;this.sync(n);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let n=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(n=e.marks[i].addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,n),i}enterInner(e,t=null,n=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=Ye(e,i,s.options);s.options&ne&&s.content.length==0&&(o|=ne),this.nodes.push(new fe(e,t,s.activeMarks,s.pendingMarks,n,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),s=-(n?n.depth+1:0)+(i?0:1),o=(l,a)=>{for(;l>=0;l--){let c=t[l];if(c==""){if(l==t.length-1||l==0)continue;for(;a>=s;a--)if(o(l-1,a))return!0;return!1}else{let u=a>0||a==0&&i?this.nodes[a].type:n&&a>=s?n.node(a-s).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;a--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let n=this.parser.schema.nodes[t];if(n.isTextblock&&n.defaultAttrs)return n}}addPendingMark(e){let t=on(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let n=this.open;n>=0;n--){let i=this.nodes[n];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==t)break}}}function tn(r){for(let e=r.firstChild,t=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&Mt.hasOwnProperty(n)&&t?(t.appendChild(e),e=t):n=="li"?t=e:n&&(t=null)}}function nn(r,e){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,e)}function rn(r){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,n=[];for(;t=e.exec(r);)n.push(t[1],t[2].trim());return n}function tt(r){let e={};for(let t in r)e[t]=r[t];return e}function sn(r,e){let t=e.schema.nodes;for(let n in t){let i=t[n];if(!i.allowsMarkType(r))continue;let s=[],o=l=>{s.push(l);for(let a=0;a<l.edgeCount;a++){let{type:c,next:u}=l.edge(a);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}function on(r,e){for(let t=0;t<e.length;t++)if(r.eq(e[t]))return e[t]}const vt=65535,bt=Math.pow(2,16);function ln(r,e){return r+e*bt}function nt(r){return r&vt}function an(r){return(r-(r&vt))/bt}const It=1,Tt=2,he=4,Et=8;class He{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(this.delInfo&Et)>0}get deletedBefore(){return(this.delInfo&(It|he))>0}get deletedAfter(){return(this.delInfo&(Tt|he))>0}get deletedAcross(){return(this.delInfo&he)>0}}class R{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&R.empty)return R.empty}recover(e){let t=0,n=nt(e);if(!this.inverted)for(let i=0;i<n;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+t+an(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let c=this.ranges[l+s],u=this.ranges[l+o],f=a+c;if(e<=f){let d=c?e==a?-1:e==f?1:t:t,h=a+i+(d<0?0:u);if(n)return h;let p=e==(t<0?a:f)?null:ln(l/3,e-a),m=e==a?Tt:e==f?It:he;return(t<0?e!=a:e!=f)&&(m|=Et),new He(h,m,p)}i+=u-c}return n?e+i:new He(e+i,0,null)}touches(e,t){let n=0,i=nt(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?n:0);if(a>e)break;let c=this.ranges[l+s],u=a+c;if(e<=u&&l==i*3)return!0;n+=this.ranges[l+o]-c}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),a=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+n];e(l,l+c,a,a+u),s+=u-c}}invert(){return new R(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?R.empty:new R(e<0?[0,-e,0]:[0,0,e])}}R.empty=new R([]);class re{constructor(e=[],t,n=0,i=e.length){this.maps=e,this.mirror=t,this.from=n,this.to=i}slice(e=0,t=this.maps.length){return new re(this.maps,this.mirror,e,t)}copy(){return new re(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,n=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?n+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?n-i-1:void 0)}}invert(){let e=new re;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],l=o.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(s);if(a!=null&&a>s&&a<this.to){s=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return n?e:new He(e,i,null)}}const Oe=Object.create(null);class C{getMap(){return R.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Oe[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in Oe)throw new RangeError("Duplicate use of step JSON ID "+e);return Oe[e]=t,t.prototype.jsonID=e,t}}class b{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new b(e,null)}static fail(e){return new b(null,e)}static fromReplace(e,t,n,i){try{return b.ok(e.replace(t,n,i))}catch(s){if(s instanceof Yt)return b.fail(s.message);throw s}}}function je(r,e,t){let n=[];for(let i=0;i<r.childCount;i++){let s=r.child(i);s.content.size&&(s=s.copy(je(s.content,e,s))),s.isInline&&(s=e(s,t,i)),n.push(s)}return g.fromArray(n)}class W extends C{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),s=new y(je(t.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return b.fromReplace(e,this.from,this.to,s)}invert(){return new V(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new W(t.pos,n.pos,this.mark)}merge(e){return e instanceof W&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new W(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new W(t.from,t.to,e.markFromJSON(t.mark))}}C.jsonID("addMark",W);class V extends C{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new y(je(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return b.fromReplace(e,this.from,this.to,n)}invert(){return new W(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new V(t.pos,n.pos,this.mark)}merge(e){return e instanceof V&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new V(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new V(t.from,t.to,e.markFromJSON(t.mark))}}C.jsonID("removeMark",V);class j extends C{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return b.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return b.fromReplace(e,this.pos,this.pos+1,new y(g.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let n=this.mark.addToSet(t.marks);if(n.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(n))return new j(this.pos,t.marks[i]);return new j(this.pos,this.mark)}}return new se(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new j(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new j(t.pos,e.markFromJSON(t.mark))}}C.jsonID("addNodeMark",j);class se extends C{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return b.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return b.fromReplace(e,this.pos,this.pos+1,new y(g.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new j(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new se(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new se(t.pos,e.markFromJSON(t.mark))}}C.jsonID("removeNodeMark",se);class N extends C{constructor(e,t,n,i=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=i}apply(e){return this.structure&&We(e,this.from,this.to)?b.fail("Structure replace would overwrite content"):b.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new R([this.from,this.to-this.from,this.slice.size])}invert(e){return new N(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new N(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof N)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?y.empty:new y(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new N(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?y.empty:new y(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new N(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new N(t.from,t.to,y.fromJSON(e,t.slice),!!t.structure)}}C.jsonID("replace",N);class A extends C{constructor(e,t,n,i,s,o,l=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(We(e,this.from,this.gapFrom)||We(e,this.gapTo,this.to)))return b.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return b.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?b.fromReplace(e,this.from,this.to,n):b.fail("Content does not fit in gap")}getMap(){return new R([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new A(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||i<t.pos||s>n.pos?null:new A(t.pos,n.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new A(t.from,t.to,t.gapFrom,t.gapTo,y.fromJSON(e,t.slice),t.insert,!!t.structure)}}C.jsonID("replaceAround",A);function We(r,e,t){let n=r.resolve(e),i=t-e,s=n.depth;for(;i>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,i--;if(i>0){let o=n.node(s).maybeChild(n.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function cn(r,e,t){return(e==0||r.canReplace(e,r.childCount))&&(t==r.childCount||r.canReplace(0,t))}function Q(r){let t=r.parent.content.cutByIndex(r.startIndex,r.endIndex);for(let n=r.depth;;--n){let i=r.$from.node(n),s=r.$from.index(n),o=r.$to.indexAfter(n);if(n<r.depth&&i.canReplace(s,o,t))return n;if(n==0||i.type.spec.isolating||!cn(i,s,o))break}return null}function Ke(r,e,t=null,n=r){let i=un(r,e),s=i&&fn(n,e);return s?i.map(rt).concat({type:e,attrs:t}).concat(s.map(rt)):null}function rt(r){return{type:r,attrs:null}}function un(r,e){let{parent:t,startIndex:n,endIndex:i}=r,s=t.contentMatchAt(n).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(n,i,o)?s:null}function fn(r,e){let{parent:t,startIndex:n,endIndex:i}=r,s=t.child(n),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let c=n;a&&c<i;c++)a=a.matchType(t.child(c).type);return!a||!a.validEnd?null:o}function _(r,e,t=1,n){let i=r.resolve(e),s=i.depth-t,o=n&&n[n.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>s;c--,u--){let f=i.node(c),d=i.index(c);if(f.type.spec.isolating)return!1;let h=f.content.cutByIndex(d,f.childCount),p=n&&n[u]||f;if(p!=f&&(h=h.replaceChild(0,p.type.create(p.attrs))),!f.canReplace(d+1,f.childCount)||!p.type.validContent(h))return!1}let l=i.indexAfter(s),a=n&&n[0];return i.node(s).canReplaceWith(l,l,a?a.type:i.node(s+1).type)}function X(r,e){let t=r.resolve(e),n=t.index();return dn(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(n,n+1)}function dn(r,e){return!!(r&&e&&!r.isLeaf&&r.canAppend(e))}function At(r,e,t=e,n=y.empty){if(e==t&&!n.size)return null;let i=r.resolve(e),s=r.resolve(t);return hn(i,s,n)?new N(e,t,n):new pn(i,s,n).fit()}function hn(r,e,t){return!t.openStart&&!t.openEnd&&r.start()==e.start()&&r.parent.canReplace(r.index(),e.index(),t.content)}class pn{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=g.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=g.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let s=this.placed,o=n.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let a=new y(s,o,l);return e>-1?new A(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new N(n.pos,i.pos,a):null}findFittable(){for(let e=1;e<=2;e++)for(let t=this.unplaced.openStart;t>=0;t--){let n,i=null;t?(i=Ne(this.unplaced.content,t-1).firstChild,n=i.content):n=this.unplaced.content;let s=n.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:a}=this.frontier[o],c,u=null;if(e==1&&(s?a.matchType(s.type)||(u=a.fillBefore(g.from(s),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:t,frontierDepth:o,parent:i,inject:u};if(e==2&&s&&(c=a.findWrapping(s.type)))return{sliceDepth:t,frontierDepth:o,parent:i,wrap:c};if(i&&a.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=Ne(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new y(e,t+1,Math.max(n,i.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=Ne(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new y(ee(e,t-1,1),t-1,s?t-1:n)}else this.unplaced=new y(ee(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,l=n?n.content:o.content,a=o.openStart-e,c=0,u=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));f=f.matchFragment(i)}let h=l.size+e-(o.content.size-o.openEnd);for(;c<l.childCount;){let m=l.child(c),w=f.matchType(m.type);if(!w)break;c++,(c>1||a==0||m.content.size)&&(f=w,u.push(Ct(m.mark(d.allowedMarks(m.marks)),c==1?a:0,c==l.childCount?h:-1)))}let p=c==l.childCount;p||(h=-1),this.placed=te(this.placed,t,g.from(u)),this.frontier[t].match=f,p&&h<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,w=l;m<h;m++){let x=w.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),w=x.content}this.unplaced=p?e==0?y.empty:new y(ee(o.content,e-1,1),e-1,h<0?o.openEnd:e-1):new y(ee(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Re(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=Re(e,t,i,n,s);if(!!o){for(let l=t-1;l>=0;l--){let{match:a,type:c}=this.frontier[l],u=Re(e,l,c,a,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=te(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let i=e.node(n),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=te(this.placed,this.depth,g.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(g.empty,!0);t.childCount&&(this.placed=te(this.placed,this.frontier.length,t))}}function ee(r,e,t){return e==0?r.cutByIndex(t,r.childCount):r.replaceChild(0,r.firstChild.copy(ee(r.firstChild.content,e-1,t)))}function te(r,e,t){return e==0?r.append(t):r.replaceChild(r.childCount-1,r.lastChild.copy(te(r.lastChild.content,e-1,t)))}function Ne(r,e){for(let t=0;t<e;t++)r=r.firstChild.content;return r}function Ct(r,e,t){if(e<=0)return r;let n=r.content;return e>1&&(n=n.replaceChild(0,Ct(n.firstChild,e-1,n.childCount==1?t-1:0))),e>0&&(n=r.type.contentMatch.fillBefore(n).append(n),t<=0&&(n=n.append(r.type.contentMatch.matchFragment(n).fillBefore(g.empty,!0)))),r.copy(n)}function Re(r,e,t,n,i){let s=r.node(e),o=i?r.indexAfter(e):r.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let l=n.fillBefore(s.content,!0,o);return l&&!mn(t,s.content,o)?l:null}function mn(r,e,t){for(let n=t;n<e.childCount;n++)if(!r.allowsMarks(e.child(n).marks))return!0;return!1}class ie extends C{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return b.fail("No node at attribute step's position");let n=Object.create(null);for(let s in t.attrs)n[s]=t.attrs[s];n[this.attr]=this.value;let i=t.type.create(n,null,t.marks);return b.fromReplace(e,this.pos,this.pos+1,new y(g.from(i),0,t.isLeaf?0:1))}getMap(){return R.empty}invert(e){return new ie(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ie(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ie(t.pos,t.attr,t.value)}}C.jsonID("attr",ie);let oe=class extends Error{};oe=function r(e){let t=Error.call(this,e);return t.__proto__=r.prototype,t};oe.prototype=Object.create(Error.prototype);oe.prototype.constructor=oe;oe.prototype.name="TransformError";const ze=Object.create(null);class k{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new gn(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=y.empty){let n=t.content.lastChild,i=null;for(let l=0;l<t.openEnd;l++)i=n,n=n.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:c}=o[l],u=e.mapping.slice(s);e.replaceRange(u.map(a.pos),u.map(c.pos),l?y.empty:t),l==0&&ot(e,s,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],a=e.mapping.slice(n),c=a.map(o.pos),u=a.map(l.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),ot(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let i=e.parent.inlineContent?new S(e):U(e.node(0),e.parent,e.pos,e.index(),t,n);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?U(e.node(0),e.node(s),e.before(s+1),e.index(s),t,n):U(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,n);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new L(e.node(0))}static atStart(e){return U(e,e,0,0,1)||new L(e)}static atEnd(e){return U(e,e,e.content.size,e.childCount,-1)||new L(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=ze[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in ze)throw new RangeError("Duplicate use of selection JSON ID "+e);return ze[e]=t,t.prototype.jsonID=e,t}getBookmark(){return S.between(this.$anchor,this.$head).getBookmark()}}k.prototype.visible=!0;class gn{constructor(e,t){this.$from=e,this.$to=t}}let it=!1;function st(r){!it&&!r.parent.inlineContent&&(it=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}class S extends k{constructor(e,t=e){st(e),st(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return k.near(n);let i=e.resolve(t.map(this.anchor));return new S(i.parent.inlineContent?i:n,n)}replace(e,t=y.empty){if(super.replace(e,t),t==y.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof S&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new be(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new S(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let i=e.resolve(t);return new this(i,n==t?i:e.resolve(n))}static between(e,t,n){let i=e.pos-t.pos;if((!n||i)&&(n=i>=0?1:-1),!t.parent.inlineContent){let s=k.findFrom(t,n,!0)||k.findFrom(t,-n,!0);if(s)t=s.$head;else return k.near(t,n)}return e.parent.inlineContent||(i==0?e=t:(e=(k.findFrom(e,-n,!0)||k.findFrom(e,n,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new S(e,t)}}k.jsonID("text",S);class be{constructor(e,t){this.anchor=e,this.head=t}map(e){return new be(e.map(this.anchor),e.map(this.head))}resolve(e){return S.between(e.resolve(this.anchor),e.resolve(this.head))}}class M extends k{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return n?k.near(s):new M(s)}content(){return new y(g.from(this.node),0,0)}eq(e){return e instanceof M&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new qe(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new M(e.resolve(t.anchor))}static create(e,t){return new M(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}M.prototype.visible=!1;k.jsonID("node",M);class qe{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new be(n,n):new qe(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&M.isSelectable(n)?new M(t):k.near(t)}}class L extends k{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=y.empty){if(t==y.empty){e.delete(0,e.doc.content.size);let n=k.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new L(e)}map(e){return new L(e)}eq(e){return e instanceof L}getBookmark(){return yn}}k.jsonID("all",L);const yn={map(){return this},resolve(r){return new L(r)}};function U(r,e,t,n,i,s=!1){if(e.inlineContent)return S.create(r,t);for(let o=n-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let l=e.child(o);if(l.isAtom){if(!s&&M.isSelectable(l))return M.create(r,t-(i<0?l.nodeSize:0))}else{let a=U(r,l,t+i,i<0?l.childCount:0,i,s);if(a)return a}t+=l.nodeSize*i}return null}function ot(r,e,t){let n=r.steps.length-1;if(n<e)return;let i=r.steps[n];if(!(i instanceof N||i instanceof A))return;let s=r.mapping.maps[n],o;s.forEach((l,a,c,u)=>{o==null&&(o=u)}),r.setSelection(k.near(r.doc.resolve(o),t))}function lt(r,e){return!e||!r?r:r.bind(e)}class de{constructor(e,t,n){this.name=e,this.init=lt(t.init,n),this.apply=lt(t.apply,n)}}new de("doc",{init(r){return r.doc||r.schema.topNodeType.createAndFill()},apply(r){return r.doc}}),new de("selection",{init(r,e){return r.selection||k.atStart(e.doc)},apply(r){return r.selection}}),new de("storedMarks",{init(r){return r.storedMarks||null},apply(r,e,t,n){return n.selection.$cursor?r.storedMarks:null}}),new de("scrollToSelection",{init(){return 0},apply(r,e){return r.scrolledIntoView?e+1:e}});function Ot(r,e,t){for(let n in r){let i=r[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=Ot(i,e,{})),t[n]=i}return t}class Y{constructor(e){this.spec=e,this.props={},e.props&&Ot(e.props,this,this.props),this.key=e.key?e.key.key:Nt("plugin")}getState(e){return e[this.key]}}const Be=Object.create(null);function Nt(r){return r in Be?r+"$"+ ++Be[r]:(Be[r]=0,r+"$")}class q{constructor(e="key"){this.key=Nt(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const wn=(r,e)=>r.selection.empty?!1:(e&&e(r.tr.deleteSelection().scrollIntoView()),!0),kn=(r,e,t)=>{let{$cursor:n}=r.selection;if(!n||(t?!t.endOfTextblock("backward",r):n.parentOffset>0))return!1;let i=Rt(n);if(!i){let o=n.blockRange(),l=o&&Q(o);return l==null?!1:(e&&e(r.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&Pt(r,i,e))return!0;if(n.parent.content.size==0&&(Z(s,"end")||M.isSelectable(s))){let o=At(r.doc,n.before(),n.after(),y.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=r.tr.step(o);l.setSelection(Z(s,"end")?k.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):M.create(l.doc,i.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==n.depth-1?(e&&e(r.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1};function Z(r,e,t=!1){for(let n=r;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&n.childCount!=1)return!1}return!1}const xn=(r,e,t)=>{let{$head:n,empty:i}=r.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("backward",r):n.parentOffset>0)return!1;s=Rt(n)}let o=s&&s.nodeBefore;return!o||!M.isSelectable(o)?!1:(e&&e(r.tr.setSelection(M.create(r.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function Rt(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){if(r.index(e)>0)return r.doc.resolve(r.before(e+1));if(r.node(e).type.spec.isolating)break}return null}const Sn=(r,e,t)=>{let{$cursor:n}=r.selection;if(!n||(t?!t.endOfTextblock("forward",r):n.parentOffset<n.parent.content.size))return!1;let i=zt(n);if(!i)return!1;let s=i.nodeAfter;if(Pt(r,i,e))return!0;if(n.parent.content.size==0&&(Z(s,"start")||M.isSelectable(s))){let o=At(r.doc,n.before(),n.after(),y.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=r.tr.step(o);l.setSelection(Z(s,"start")?k.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):M.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==n.depth-1?(e&&e(r.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},Mn=(r,e,t)=>{let{$head:n,empty:i}=r.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("forward",r):n.parentOffset<n.parent.content.size)return!1;s=zt(n)}let o=s&&s.nodeAfter;return!o||!M.isSelectable(o)?!1:(e&&e(r.tr.setSelection(M.create(r.doc,s.pos)).scrollIntoView()),!0)};function zt(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){let t=r.node(e);if(r.index(e)+1<t.childCount)return r.doc.resolve(r.after(e+1));if(t.type.spec.isolating)break}return null}const vn=(r,e)=>{let{$from:t,$to:n}=r.selection,i=t.blockRange(n),s=i&&Q(i);return s==null?!1:(e&&e(r.tr.lift(i,s).scrollIntoView()),!0)},bn=(r,e)=>{let{$head:t,$anchor:n}=r.selection;return!t.parent.type.spec.code||!t.sameParent(n)?!1:(e&&e(r.tr.insertText(`
`).scrollIntoView()),!0)};function Bt(r){for(let e=0;e<r.edgeCount;e++){let{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const In=(r,e)=>{let{$head:t,$anchor:n}=r.selection;if(!t.parent.type.spec.code||!t.sameParent(n))return!1;let i=t.node(-1),s=t.indexAfter(-1),o=Bt(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let l=t.after(),a=r.tr.replaceWith(l,l,o.createAndFill());a.setSelection(k.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},Tn=(r,e)=>{let t=r.selection,{$from:n,$to:i}=t;if(t instanceof L||n.parent.inlineContent||i.parent.inlineContent)return!1;let s=Bt(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,l=r.tr.insert(o,s.createAndFill());l.setSelection(S.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},En=(r,e)=>{let{$cursor:t}=r.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let s=t.before();if(_(r.doc,s))return e&&e(r.tr.split(s).scrollIntoView()),!0}let n=t.blockRange(),i=n&&Q(n);return i==null?!1:(e&&e(r.tr.lift(n,i).scrollIntoView()),!0)},An=(r,e)=>{let{$from:t,to:n}=r.selection,i,s=t.sharedDepth(n);return s==0?!1:(i=t.before(s),e&&e(r.tr.setSelection(M.create(r.doc,i))),!0)};function Cn(r,e,t){let n=e.nodeBefore,i=e.nodeAfter,s=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(s-1,s)?(t&&t(r.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||X(r.doc,e.pos))?!1:(t&&t(r.tr.clearIncompatible(e.pos,n.type,n.contentMatchAt(n.childCount)).join(e.pos).scrollIntoView()),!0)}function Pt(r,e,t){let n=e.nodeBefore,i=e.nodeAfter,s,o;if(n.type.spec.isolating||i.type.spec.isolating)return!1;if(Cn(r,e,t))return!0;let l=e.parent.canReplace(e.index(),e.index()+1);if(l&&(s=(o=n.contentMatchAt(n.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(t){let f=e.pos+i.nodeSize,d=g.empty;for(let m=s.length-1;m>=0;m--)d=g.from(s[m].create(null,d));d=g.from(n.copy(d));let h=r.tr.step(new A(e.pos-1,f,e.pos,f,new y(d,1,0),s.length,!0)),p=f+2*s.length;X(h.doc,p)&&h.join(p),t(h.scrollIntoView())}return!0}let a=k.findFrom(e,1),c=a&&a.$from.blockRange(a.$to),u=c&&Q(c);if(u!=null&&u>=e.depth)return t&&t(r.tr.lift(c,u).scrollIntoView()),!0;if(l&&Z(i,"start",!0)&&Z(n,"end")){let f=n,d=[];for(;d.push(f),!f.isTextblock;)f=f.lastChild;let h=i,p=1;for(;!h.isTextblock;h=h.firstChild)p++;if(f.canReplace(f.childCount,f.childCount,h.content)){if(t){let m=g.empty;for(let x=d.length-1;x>=0;x--)m=g.from(d[x].copy(m));let w=r.tr.step(new A(e.pos-d.length,e.pos+i.nodeSize,e.pos+p,e.pos+i.nodeSize-p,new y(m,d.length,0),0,!0));t(w.scrollIntoView())}return!0}}return!1}function Ft(r){return function(e,t){let n=e.selection,i=r<0?n.$from:n.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(t&&t(e.tr.setSelection(S.create(e.doc,r<0?i.start(s):i.end(s)))),!0):!1}}const On=Ft(-1),Nn=Ft(1);function Rn(r,e=null){return function(t,n){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),l=o&&Ke(o,r,e);return l?(n&&n(t.tr.wrap(o,l).scrollIntoView()),!0):!1}}function at(r,e=null){return function(t,n){let{from:i,to:s}=t.selection,o=!1;return t.doc.nodesBetween(i,s,(l,a)=>{if(o)return!1;if(!(!l.isTextblock||l.hasMarkup(r,e)))if(l.type==r)o=!0;else{let c=t.doc.resolve(a),u=c.index();o=c.parent.canReplaceWith(u,u+1,r)}}),o?(n&&n(t.tr.setBlockType(i,s,r,e).scrollIntoView()),!0):!1}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function zn(r,e=null){return function(t,n){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),l=!1,a=o;if(!o)return!1;if(o.depth>=2&&i.node(o.depth-1).type.compatibleContent(r)&&o.startIndex==0){if(i.index(o.depth-1)==0)return!1;let u=t.doc.resolve(o.start-2);a=new Je(u,u,o.depth),o.endIndex<o.parent.childCount&&(o=new Je(i,t.doc.resolve(s.end(o.depth)),o.depth)),l=!0}let c=Ke(a,r,e,o);return c?(n&&n(Bn(t.tr,o,c,l,r).scrollIntoView()),!0):!1}}function Bn(r,e,t,n,i){let s=g.empty;for(let u=t.length-1;u>=0;u--)s=g.from(t[u].type.create(t[u].attrs,s));r.step(new A(e.start-(n?2:0),e.end,e.start,e.end,new y(s,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==i&&(o=u+1);let l=t.length-o,a=e.start+t.length-(n?2:0),c=e.parent;for(let u=e.startIndex,f=e.endIndex,d=!0;u<f;u++,d=!1)!d&&_(r.doc,a,l)&&(r.split(a,l),a+=2*l),a+=c.child(u).nodeSize;return r}function Pn(r){return function(e,t){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,o=>o.childCount>0&&o.firstChild.type==r);return s?t?n.node(s.depth-1).type==r?Fn(e,t,r,s):Ln(e,t,s):!0:!1}}function Fn(r,e,t,n){let i=r.tr,s=n.end,o=n.$to.end(n.depth);s<o&&(i.step(new A(s-1,o,s,o,new y(g.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new Je(i.doc.resolve(n.$from.pos),i.doc.resolve(o),n.depth));const l=Q(n);if(l==null)return!1;i.lift(n,l);let a=i.mapping.map(s,-1)-1;return X(i.doc,a)&&i.join(a),e(i.scrollIntoView()),!0}function Ln(r,e,t){let n=r.tr,i=t.parent;for(let h=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)h-=i.child(p).nodeSize,n.delete(h-1,h+1);let s=n.doc.resolve(t.start),o=s.nodeAfter;if(n.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let l=t.startIndex==0,a=t.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(l?0:1),u+1,o.content.append(a?g.empty:g.from(i))))return!1;let f=s.pos,d=f+o.nodeSize;return n.step(new A(f-(l?1:0),d+(a?1:0),f+1,d-1,new y((l?g.empty:g.from(i.copy(g.empty))).append(a?g.empty:g.from(i.copy(g.empty))),l?0:1,a?0:1),l?0:1)),e(n.scrollIntoView()),!0}function $n(r){return function(e,t){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,c=>c.childCount>0&&c.firstChild.type==r);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,a=l.child(o-1);if(a.type!=r)return!1;if(t){let c=a.lastChild&&a.lastChild.type==l.type,u=g.from(c?r.create():null),f=new y(g.from(r.create(null,g.from(l.type.create(null,u)))),c?3:1,0),d=s.start,h=s.end;t(e.tr.step(new A(d-(c?3:1),h,d,h,f,1,!0)).scrollIntoView())}return!0}}function Lt(r){const{state:e,transaction:t}=r;let{selection:n}=t,{doc:i}=t,{storedMarks:s}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return n},get doc(){return i},get tr(){return n=t.selection,i=t.doc,s=t.storedMarks,t}}}class Dn{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:i}=t,{tr:s}=n,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([l,a])=>[l,(...u)=>{const f=a(...u)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:i,state:s}=this,{view:o}=i,l=[],a=!!e,c=e||s.tr,u=()=>(!a&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),l.every(d=>d===!0)),f={...Object.fromEntries(Object.entries(n).map(([d,h])=>[d,(...m)=>{const w=this.buildProps(c,t),x=h(...m)(w);return l.push(x),f}])),run:u};return f}createCan(e){const{rawCommands:t,state:n}=this,i=!1,s=e||n.tr,o=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(t).map(([a,c])=>[a,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,t=!0){const{rawCommands:n,editor:i,state:s}=this,{view:o}=i;s.storedMarks&&e.setStoredMarks(s.storedMarks);const l={tr:e,editor:i,view:o,state:Lt({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([a,c])=>[a,(...u)=>c(...u)(l)]))}};return l}}function I(r,e,t){return r.config[e]===void 0&&r.parent?I(r.parent,e,t):typeof r.config[e]=="function"?r.config[e].bind({...t,parent:r.parent?I(r.parent,e,t):null}):r.config[e]}function Jn(r){const e=r.filter(i=>i.type==="extension"),t=r.filter(i=>i.type==="node"),n=r.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:n}}function E(r,e){if(typeof r=="string"){if(!e.nodes[r])throw Error(`There is no node type named '${r}'. Maybe you forgot to add the extension?`);return e.nodes[r]}return r}function $(...r){return r.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(([i,s])=>{if(!n[i]){n[i]=s;return}i==="class"?n[i]=[n[i],s].join(" "):i==="style"?n[i]=[n[i],s].join("; "):n[i]=s}),n},{})}function Hn(r){return typeof r=="function"}function v(r,e=void 0,...t){return Hn(r)?e?r.bind(e)(...t):r(...t):r}function Wn(r){return Object.prototype.toString.call(r)==="[object RegExp]"}class Ie{constructor(e){this.find=e.find,this.handler=e.handler}}class Vn{constructor(e){this.find=e.find,this.handler=e.handler}}function jn(r){return Object.prototype.toString.call(r).slice(8,-1)}function Pe(r){return jn(r)!=="Object"?!1:r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype}function Te(r,e){const t={...r};return Pe(r)&&Pe(e)&&Object.keys(e).forEach(n=>{Pe(e[n])?n in r?t[n]=Te(r[n],e[n]):Object.assign(t,{[n]:e[n]}):Object.assign(t,{[n]:e[n]})}),t}class P{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=v(I(this,"addOptions",{name:this.name}))),this.storage=v(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new P(e)}configure(e={}){const t=this.extend();return t.options=Te(this.options,e),t.storage=v(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new P(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=v(I(t,"addOptions",{name:t.name})),t.storage=v(I(t,"addStorage",{name:t.name,options:t.options})),t}}function Kn(r,e,t){const{from:n,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=t||{};let l="",a=!0;return r.nodesBetween(n,i,(c,u,f,d)=>{var h;const p=o==null?void 0:o[c.type.name];p?(c.isBlock&&!a&&(l+=s,a=!0),f&&(l+=p({node:c,pos:u,parent:f,index:d,range:e}))):c.isText?(l+=(h=c==null?void 0:c.text)===null||h===void 0?void 0:h.slice(Math.max(n,u)-u,i-u),a=!1):c.isBlock&&!a&&(l+=s,a=!0)}),l}function qn(r){return Object.fromEntries(Object.entries(r.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}P.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new Y({key:new q("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:r}=this,{state:e,schema:t}=r,{doc:n,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(u=>u.$from.pos)),l=Math.max(...s.map(u=>u.$to.pos)),a=qn(t);return Kn(n,{from:o,to:l},{textSerializers:a})}}})]}});const Gn=()=>({editor:r,view:e})=>(requestAnimationFrame(()=>{var t;r.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),Un=(r=!1)=>({commands:e})=>e.setContent("",r),_n=()=>({state:r,tr:e,dispatch:t})=>{const{selection:n}=e,{ranges:i}=n;return t&&i.forEach(({$from:s,$to:o})=>{r.doc.nodesBetween(s.pos,o.pos,(l,a)=>{if(l.type.isText)return;const{doc:c,mapping:u}=e,f=c.resolve(u.map(a)),d=c.resolve(u.map(a+l.nodeSize)),h=f.blockRange(d);if(!h)return;const p=Q(h);if(l.type.isTextblock){const{defaultType:m}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(h.start,m)}(p||p===0)&&e.lift(h,p)})}),!0},Zn=r=>e=>r(e),Qn=()=>({state:r,dispatch:e})=>Tn(r,e),Xn=r=>({tr:e,state:t,dispatch:n})=>{const i=E(r,t.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(n){const a=s.before(o),c=s.after(o);e.delete(a,c).scrollIntoView()}return!0}return!1},Yn=r=>({tr:e,dispatch:t})=>{const{from:n,to:i}=r;return t&&e.delete(n,i),!0},er=()=>({state:r,dispatch:e})=>wn(r,e),tr=()=>({commands:r})=>r.keyboardShortcut("Enter"),nr=()=>({state:r,dispatch:e})=>In(r,e);function ke(r,e,t={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>t.strict?e[i]===r[i]:Wn(e[i])?e[i].test(r[i]):e[i]===r[i]):!0}function Ve(r,e,t={}){return r.find(n=>n.type===e&&ke(n.attrs,t))}function rr(r,e,t={}){return!!Ve(r,e,t)}function Ge(r,e,t={}){if(!r||!e)return;let n=r.parent.childAfter(r.parentOffset);if(r.parentOffset===n.offset&&n.offset!==0&&(n=r.parent.childBefore(r.parentOffset)),!n.node)return;const i=Ve([...n.node.marks],e,t);if(!i)return;let s=n.index,o=r.start()+n.offset,l=s+1,a=o+n.node.nodeSize;for(Ve([...n.node.marks],e,t);s>0&&i.isInSet(r.parent.child(s-1).marks);)s-=1,o-=r.parent.child(s).nodeSize;for(;l<r.parent.childCount&&rr([...r.parent.child(l).marks],e,t);)a+=r.parent.child(l).nodeSize,l+=1;return{from:o,to:a}}function H(r,e){if(typeof r=="string"){if(!e.marks[r])throw Error(`There is no mark type named '${r}'. Maybe you forgot to add the extension?`);return e.marks[r]}return r}const ir=(r,e={})=>({tr:t,state:n,dispatch:i})=>{const s=H(r,n.schema),{doc:o,selection:l}=t,{$from:a,from:c,to:u}=l;if(i){const f=Ge(a,s,e);if(f&&f.from<=c&&f.to>=u){const d=S.create(o,f.from,f.to);t.setSelection(d)}}return!0},sr=r=>e=>{const t=typeof r=="function"?r(e):r;for(let n=0;n<t.length;n+=1)if(t[n](e))return!0;return!1};function $t(r){return r instanceof S}function K(r=0,e=0,t=0){return Math.min(Math.max(r,e),t)}function or(r,e=null){if(!e)return null;const t=k.atStart(r),n=k.atEnd(r);if(e==="start"||e===!0)return t;if(e==="end")return n;const i=t.from,s=n.to;return e==="all"?S.create(r,K(0,i,s),K(r.content.size,i,s)):S.create(r,K(e,i,s),K(e,i,s))}function Ue(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const lr=(r=null,e={})=>({editor:t,view:n,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{Ue()&&n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(n.hasFocus()&&r===null||r===!1)return!0;if(s&&r===null&&!$t(t.state.selection))return o(),!0;const l=or(i.doc,r)||t.state.selection,a=t.state.selection.eq(l);return s&&(a||i.setSelection(l),a&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},ar=(r,e)=>t=>r.every((n,i)=>e(n,{...t,index:i})),cr=(r,e)=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},r,e);function ct(r){const e=`<body>${r}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function xe(r,e,t){if(t={slice:!0,parseOptions:{},...t},typeof r=="object"&&r!==null)try{return Array.isArray(r)?g.fromArray(r.map(n=>e.nodeFromJSON(n))):e.nodeFromJSON(r)}catch(n){return console.warn("[tiptap warn]: Invalid content.","Passed value:",r,"Error:",n),xe("",e,t)}if(typeof r=="string"){const n=ge.fromSchema(e);return t.slice?n.parseSlice(ct(r),t.parseOptions).content:n.parse(ct(r),t.parseOptions)}return xe("",e,t)}function ur(r,e,t){const n=r.steps.length-1;if(n<e)return;const i=r.steps[n];if(!(i instanceof N||i instanceof A))return;const s=r.mapping.maps[n];let o=0;s.forEach((l,a,c,u)=>{o===0&&(o=u)}),r.setSelection(k.near(r.doc.resolve(o),t))}const fr=r=>r.toString().startsWith("<"),dr=(r,e,t)=>({tr:n,dispatch:i,editor:s})=>{if(i){t={parseOptions:{},updateSelection:!0,...t};const o=xe(e,s.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(o.toString()==="<>")return!0;let{from:l,to:a}=typeof r=="number"?{from:r,to:r}:r,c=!0,u=!0;if((fr(o)?o:[o]).forEach(d=>{d.check(),c=c?d.isText&&d.marks.length===0:!1,u=u?d.isBlock:!1}),l===a&&u){const{parent:d}=n.doc.resolve(l);d.isTextblock&&!d.type.spec.code&&!d.childCount&&(l-=1,a+=1)}c?n.insertText(e,l,a):n.replaceWith(l,a,o),t.updateSelection&&ur(n,n.steps.length-1,-1)}return!0},hr=()=>({state:r,dispatch:e})=>kn(r,e),pr=()=>({state:r,dispatch:e})=>Sn(r,e);function Dt(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function mr(r){const e=r.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let n,i,s,o;for(let l=0;l<e.length-1;l+=1){const a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))Ue()||Dt()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return n&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),s&&(t=`Shift-${t}`),t}const gr=r=>({editor:e,view:t,tr:n,dispatch:i})=>{const s=mr(r).split(/-(?!$)/),o=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,l))});return a==null||a.steps.forEach(c=>{const u=c.map(n.mapping);u&&i&&n.maybeStep(u)}),!0};function _e(r,e,t={}){const{from:n,to:i,empty:s}=r.selection,o=e?E(e,r.schema):null,l=[];r.doc.nodesBetween(n,i,(f,d)=>{if(f.isText)return;const h=Math.max(n,d),p=Math.min(i,d+f.nodeSize);l.push({node:f,from:h,to:p})});const a=i-n,c=l.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>ke(f.node.attrs,t,{strict:!1}));return s?!!c.length:c.reduce((f,d)=>f+d.to-d.from,0)>=a}const yr=(r,e={})=>({state:t,dispatch:n})=>{const i=E(r,t.schema);return _e(t,i,e)?vn(t,n):!1},wr=()=>({state:r,dispatch:e})=>En(r,e),kr=r=>({state:e,dispatch:t})=>{const n=E(r,e.schema);return Pn(n)(e,t)},xr=()=>({state:r,dispatch:e})=>bn(r,e);function Jt(r,e){return e.nodes[r]?"node":e.marks[r]?"mark":null}function ut(r,e){const t=typeof e=="string"?[e]:e;return Object.keys(r).reduce((n,i)=>(t.includes(i)||(n[i]=r[i]),n),{})}const Sr=(r,e)=>({tr:t,state:n,dispatch:i})=>{let s=null,o=null;const l=Jt(typeof r=="string"?r:r.name,n.schema);return l?(l==="node"&&(s=E(r,n.schema)),l==="mark"&&(o=H(r,n.schema)),i&&t.selection.ranges.forEach(a=>{n.doc.nodesBetween(a.$from.pos,a.$to.pos,(c,u)=>{s&&s===c.type&&t.setNodeMarkup(u,void 0,ut(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(f=>{o===f.type&&t.addMark(u,u+c.nodeSize,o.create(ut(f.attrs,e)))})})}),!0):!1},Mr=()=>({tr:r,dispatch:e})=>(e&&r.scrollIntoView(),!0),vr=()=>({tr:r,commands:e})=>e.setTextSelection({from:0,to:r.doc.content.size}),br=()=>({state:r,dispatch:e})=>xn(r,e),Ir=()=>({state:r,dispatch:e})=>Mn(r,e),Tr=()=>({state:r,dispatch:e})=>An(r,e),Er=()=>({state:r,dispatch:e})=>Nn(r,e),Ar=()=>({state:r,dispatch:e})=>On(r,e);function Cr(r,e,t={}){return xe(r,e,{slice:!1,parseOptions:t})}const Or=(r,e=!1,t={})=>({tr:n,editor:i,dispatch:s})=>{const{doc:o}=n,l=Cr(r,i.schema,t);return s&&n.replaceWith(0,o.content.size,l).setMeta("preventUpdate",!e),!0};function Nr(r){for(let e=0;e<r.edgeCount;e+=1){const{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function Rr(r,e){for(let t=r.depth;t>0;t-=1){const n=r.node(t);if(e(n))return{pos:t>0?r.before(t):0,start:r.start(t),depth:t,node:n}}}function Ze(r){return e=>Rr(e.$from,r)}function zr(r,e){const t=H(e,r.schema),{from:n,to:i,empty:s}=r.selection,o=[];s?(r.storedMarks&&o.push(...r.storedMarks),o.push(...r.selection.$head.marks())):r.doc.nodesBetween(n,i,a=>{o.push(...a.marks)});const l=o.find(a=>a.type.name===t.name);return l?{...l.attrs}:{}}function Ht(r,e,t){const n=[];return r===e?t.resolve(r).marks().forEach(i=>{const s=t.resolve(r-1),o=Ge(s,i.type);!o||n.push({mark:i,...o})}):t.nodesBetween(r,e,(i,s)=>{n.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),n}function Br(r,e,t={}){const{empty:n,ranges:i}=r.selection,s=e?H(e,r.schema):null;if(n)return!!(r.storedMarks||r.selection.$from.marks()).filter(f=>s?s.name===f.type.name:!0).find(f=>ke(f.attrs,t,{strict:!1}));let o=0;const l=[];if(i.forEach(({$from:f,$to:d})=>{const h=f.pos,p=d.pos;r.doc.nodesBetween(h,p,(m,w)=>{if(!m.isText&&!m.marks.length)return;const x=Math.max(h,w),ae=Math.min(p,w+m.nodeSize),Ee=ae-x;o+=Ee,l.push(...m.marks.map(Ae=>({mark:Ae,from:x,to:ae})))})}),o===0)return!1;const a=l.filter(f=>s?s.name===f.mark.type.name:!0).filter(f=>ke(f.mark.attrs,t,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),c=l.filter(f=>s?f.mark.type!==s&&f.mark.type.excludes(s):!0).reduce((f,d)=>f+d.to-d.from,0);return(a>0?a+c:a)>=o}function ft(r,e){const{nodeExtensions:t}=Jn(e),n=t.find(o=>o.name===r);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},s=v(I(n,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function Pr(r,e,t){var n;const{selection:i}=e;let s=null;if($t(i)&&(s=i.$cursor),s){const l=(n=r.storedMarks)!==null&&n!==void 0?n:s.marks();return!!t.isInSet(l)||!l.some(a=>a.type.excludes(t))}const{ranges:o}=i;return o.some(({$from:l,$to:a})=>{let c=l.depth===0?r.doc.inlineContent&&r.doc.type.allowsMarkType(t):!1;return r.doc.nodesBetween(l.pos,a.pos,(u,f,d)=>{if(c)return!1;if(u.isInline){const h=!d||d.type.allowsMarkType(t),p=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=h&&p}return!c}),c})}const Fr=(r,e={})=>({tr:t,state:n,dispatch:i})=>{const{selection:s}=t,{empty:o,ranges:l}=s,a=H(r,n.schema);if(i)if(o){const c=zr(n,a);t.addStoredMark(a.create({...c,...e}))}else l.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;n.doc.nodesBetween(u,f,(d,h)=>{const p=Math.max(h,u),m=Math.min(h+d.nodeSize,f);d.marks.find(x=>x.type===a)?d.marks.forEach(x=>{a===x.type&&t.addMark(p,m,a.create({...x.attrs,...e}))}):t.addMark(p,m,a.create(e))})});return Pr(n,t,a)},Lr=(r,e)=>({tr:t})=>(t.setMeta(r,e),!0),$r=(r,e={})=>({state:t,dispatch:n,chain:i})=>{const s=E(r,t.schema);return s.isTextblock?i().command(({commands:o})=>at(s,e)(t)?!0:o.clearNodes()).command(({state:o})=>at(s,e)(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Dr=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,i=K(r,0,n.content.size),s=M.create(n,i);e.setSelection(s)}return!0},Jr=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,{from:i,to:s}=typeof r=="number"?{from:r,to:r}:r,o=S.atStart(n).from,l=S.atEnd(n).to,a=K(i,o,l),c=K(s,o,l),u=S.create(n,a,c);e.setSelection(u)}return!0},Hr=r=>({state:e,dispatch:t})=>{const n=E(r,e.schema);return $n(n)(e,t)};function pe(r,e,t){return Object.fromEntries(Object.entries(t).filter(([n])=>{const i=r.find(s=>s.type===e&&s.name===n);return i?i.attribute.keepOnSplit:!1}))}function dt(r,e){const t=r.storedMarks||r.selection.$to.parentOffset&&r.selection.$from.marks();if(t){const n=t.filter(i=>e==null?void 0:e.includes(i.type.name));r.tr.ensureMarks(n)}}const Wr=({keepMarks:r=!0}={})=>({tr:e,state:t,dispatch:n,editor:i})=>{const{selection:s,doc:o}=e,{$from:l,$to:a}=s,c=i.extensionManager.attributes,u=pe(c,l.node().type.name,l.node().attrs);if(s instanceof M&&s.node.isBlock)return!l.parentOffset||!_(o,l.pos)?!1:(n&&(r&&dt(t,i.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;if(n){const f=a.parentOffset===a.parent.content.size;s instanceof S&&e.deleteSelection();const d=l.depth===0?void 0:Nr(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=f&&d?[{type:d,attrs:u}]:void 0,p=_(e.doc,e.mapping.map(l.pos),1,h);if(!h&&!p&&_(e.doc,e.mapping.map(l.pos),1,d?[{type:d}]:void 0)&&(p=!0,h=d?[{type:d,attrs:u}]:void 0),p&&(e.split(e.mapping.map(l.pos),1,h),d&&!f&&!l.parentOffset&&l.parent.type!==d)){const m=e.mapping.map(l.before()),w=e.doc.resolve(m);l.node(-1).canReplaceWith(w.index(),w.index()+1,d)&&e.setNodeMarkup(e.mapping.map(l.before()),d)}r&&dt(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0},Vr=r=>({tr:e,state:t,dispatch:n,editor:i})=>{var s;const o=E(r,t.schema),{$from:l,$to:a}=t.selection,c=t.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(a))return!1;const u=l.node(-1);if(u.type!==o)return!1;const f=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(n){let w=g.empty;const x=l.index(-1)?1:l.index(-2)?2:3;for(let G=l.depth-x;G>=l.depth-3;G-=1)w=g.from(l.node(G).copy(w));const ae=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,Ee=pe(f,l.node().type.name,l.node().attrs),Ae=((s=o.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(Ee))||void 0;w=w.append(g.from(o.createAndFill(null,Ae)||void 0));const Xe=l.before(l.depth-(x-1));e.replace(Xe,l.after(-ae),new y(w,4-x,0));let ce=-1;e.doc.nodesBetween(Xe,e.doc.content.size,(G,Gt)=>{if(ce>-1)return!1;G.isTextblock&&G.content.size===0&&(ce=Gt+1)}),ce>-1&&e.setSelection(S.near(e.doc.resolve(ce))),e.scrollIntoView()}return!0}const d=a.pos===l.end()?u.contentMatchAt(0).defaultType:null,h=pe(f,u.type.name,u.attrs),p=pe(f,l.node().type.name,l.node().attrs);e.delete(l.pos,a.pos);const m=d?[{type:o,attrs:h},{type:d,attrs:p}]:[{type:o,attrs:h}];return _(e.doc,l.pos,2)?(n&&e.split(l.pos,2,m).scrollIntoView(),!0):!1},ht=(r,e)=>{const t=Ze(o=>o.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(n===void 0)return!0;const i=r.doc.nodeAt(n);return t.node.type===(i==null?void 0:i.type)&&X(r.doc,t.pos)&&r.join(t.pos),!0},pt=(r,e)=>{const t=Ze(o=>o.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(t.start).after(t.depth);if(n===void 0)return!0;const i=r.doc.nodeAt(n);return t.node.type===(i==null?void 0:i.type)&&X(r.doc,n)&&r.join(n),!0},jr=(r,e)=>({editor:t,tr:n,state:i,dispatch:s,chain:o,commands:l,can:a})=>{const{extensions:c}=t.extensionManager,u=E(r,i.schema),f=E(e,i.schema),{selection:d}=i,{$from:h,$to:p}=d,m=h.blockRange(p);if(!m)return!1;const w=Ze(x=>ft(x.type.name,c))(d);if(m.depth>=1&&w&&m.depth-w.depth<=1){if(w.node.type===u)return l.liftListItem(f);if(ft(w.node.type.name,c)&&u.validContent(w.node.content)&&s)return o().command(()=>(n.setNodeMarkup(w.pos,u),!0)).command(()=>ht(n,u)).command(()=>pt(n,u)).run()}return o().command(()=>a().wrapInList(u)?!0:l.clearNodes()).wrapInList(u).command(()=>ht(n,u)).command(()=>pt(n,u)).run()},Kr=(r,e={},t={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:s=!1}=t,o=H(r,n.schema);return Br(n,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},qr=(r,e,t={})=>({state:n,commands:i})=>{const s=E(r,n.schema),o=E(e,n.schema);return _e(n,s,t)?i.setNode(o):i.setNode(s,t)},Gr=(r,e={})=>({state:t,commands:n})=>{const i=E(r,t.schema);return _e(t,i,e)?n.lift(i):n.wrapIn(i,e)},Ur=()=>({state:r,dispatch:e})=>{const t=r.plugins;for(let n=0;n<t.length;n+=1){const i=t[n];let s;if(i.spec.isInputRules&&(s=i.getState(r))){if(e){const o=r.tr,l=s.transform;for(let a=l.steps.length-1;a>=0;a-=1)o.step(l.steps[a].invert(l.docs[a]));if(s.text){const a=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,r.schema.text(s.text,a))}else o.delete(s.from,s.to)}return!0}}return!1},_r=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,{empty:n,ranges:i}=t;return n||e&&i.forEach(s=>{r.removeMark(s.$from.pos,s.$to.pos)}),!0},Zr=(r,e={})=>({tr:t,state:n,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=t,a=H(r,n.schema),{$from:c,empty:u,ranges:f}=l;if(!i)return!0;if(u&&o){let{from:d,to:h}=l;const p=(s=c.marks().find(w=>w.type===a))===null||s===void 0?void 0:s.attrs,m=Ge(c,a,p);m&&(d=m.from,h=m.to),t.removeMark(d,h,a)}else f.forEach(d=>{t.removeMark(d.$from.pos,d.$to.pos,a)});return t.removeStoredMark(a),!0},Qr=(r,e={})=>({tr:t,state:n,dispatch:i})=>{let s=null,o=null;const l=Jt(typeof r=="string"?r:r.name,n.schema);return l?(l==="node"&&(s=E(r,n.schema)),l==="mark"&&(o=H(r,n.schema)),i&&t.selection.ranges.forEach(a=>{const c=a.$from.pos,u=a.$to.pos;n.doc.nodesBetween(c,u,(f,d)=>{s&&s===f.type&&t.setNodeMarkup(d,void 0,{...f.attrs,...e}),o&&f.marks.length&&f.marks.forEach(h=>{if(o===h.type){const p=Math.max(d,c),m=Math.min(d+f.nodeSize,u);t.addMark(p,m,o.create({...h.attrs,...e}))}})})}),!0):!1},Xr=(r,e={})=>({state:t,dispatch:n})=>{const i=E(r,t.schema);return Rn(i,e)(t,n)},Yr=(r,e={})=>({state:t,dispatch:n})=>{const i=E(r,t.schema);return zn(i,e)(t,n)};var ei=Object.freeze({__proto__:null,blur:Gn,clearContent:Un,clearNodes:_n,command:Zn,createParagraphNear:Qn,deleteNode:Xn,deleteRange:Yn,deleteSelection:er,enter:tr,exitCode:nr,extendMarkRange:ir,first:sr,focus:lr,forEach:ar,insertContent:cr,insertContentAt:dr,joinBackward:hr,joinForward:pr,keyboardShortcut:gr,lift:yr,liftEmptyBlock:wr,liftListItem:kr,newlineInCode:xr,resetAttributes:Sr,scrollIntoView:Mr,selectAll:vr,selectNodeBackward:br,selectNodeForward:Ir,selectParentNode:Tr,selectTextblockEnd:Er,selectTextblockStart:Ar,setContent:Or,setMark:Fr,setMeta:Lr,setNode:$r,setNodeSelection:Dr,setTextSelection:Jr,sinkListItem:Hr,splitBlock:Wr,splitListItem:Vr,toggleList:jr,toggleMark:Kr,toggleNode:qr,toggleWrap:Gr,undoInputRule:Ur,unsetAllMarks:_r,unsetMark:Zr,updateAttributes:Qr,wrapIn:Xr,wrapInList:Yr});P.create({name:"commands",addCommands(){return{...ei}}});P.create({name:"editable",addProseMirrorPlugins(){return[new Y({key:new q("editable"),props:{editable:()=>this.editor.options.editable}})]}});P.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:r}=this;return[new Y({key:new q("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{r.isFocused=!0;const n=r.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,t)=>{r.isFocused=!1;const n=r.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}});P.create({name:"keymap",addKeyboardShortcuts(){const r=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:a,doc:c}=l,{empty:u,$anchor:f}=a,{pos:d,parent:h}=f,p=k.atStart(c).from===d;return!u||!p||!h.type.isTextblock||h.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.joinForward(),()=>o.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:r,"Mod-Backspace":r,"Shift-Backspace":r,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},s={...n,"Ctrl-h":r,"Alt-Backspace":r,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Ue()||Dt()?s:i},addProseMirrorPlugins(){return[new Y({key:new q("clearDocument"),appendTransaction:(r,e,t)=>{if(!(r.some(p=>p.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:i,from:s,to:o}=e.selection,l=k.atStart(e.doc).from,a=k.atEnd(e.doc).to,c=s===l&&o===a,u=t.doc.textBetween(0,t.doc.content.size," "," ").length===0;if(i||!c||!u)return;const f=t.tr,d=Lt({state:t,transaction:f}),{commands:h}=new Dn({editor:this.editor,state:d});if(h.clearNodes(),!!f.steps.length)return f}})]}});P.create({name:"tabindex",addProseMirrorPlugins(){return[new Y({key:new q("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});function Se(r){return new Ie({find:r.find,handler:({state:e,range:t,match:n})=>{const i=v(r.getAttributes,void 0,n);if(i===!1||i===null)return null;const{tr:s}=e,o=n[n.length-1],l=n[0];let a=t.to;if(o){const c=l.search(/\S/),u=t.from+l.indexOf(o),f=u+o.length;if(Ht(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===r.type&&m!==h.mark.type)).filter(h=>h.to>u).length)return null;f<t.to&&s.delete(f,t.to),u>t.from&&s.delete(t.from+c,u),a=t.from+c+o.length,s.addMark(t.from+c,a,r.type.create(i||{})),s.removeStoredMark(r.type)}}})}function ti(r){return new Ie({find:r.find,handler:({state:e,range:t,match:n})=>{const i=v(r.getAttributes,void 0,n)||{},{tr:s}=e,o=t.from;let l=t.to;if(n[1]){const a=n[0].lastIndexOf(n[1]);let c=o+a;c>l?c=l:l=c+n[1].length;const u=n[0][n[0].length-1];s.insertText(u,o+n[0].length-1),s.replaceWith(c,l,r.type.create(i))}else n[0]&&s.replaceWith(o,l,r.type.create(i))}})}function ni(r){return new Ie({find:r.find,handler:({state:e,range:t,match:n})=>{const i=e.doc.resolve(t.from),s=v(r.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),r.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,r.type,s)}})}function Qe(r){return new Ie({find:r.find,handler:({state:e,range:t,match:n})=>{const i=v(r.getAttributes,void 0,n)||{},s=e.tr.delete(t.from,t.to),l=s.doc.resolve(t.from).blockRange(),a=l&&Ke(l,r.type,i);if(!a)return null;s.wrap(l,a);const c=s.doc.resolve(t.from-1).nodeBefore;c&&c.type===r.type&&X(s.doc,t.from-1)&&(!r.joinPredicate||r.joinPredicate(n,c))&&s.join(t.from-1)}})}class le{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=v(I(this,"addOptions",{name:this.name}))),this.storage=v(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new le(e)}configure(e={}){const t=this.extend();return t.options=Te(this.options,e),t.storage=v(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new le(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=v(I(t,"addOptions",{name:t.name})),t.storage=v(I(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const a=o.find(c=>(c==null?void 0:c.type.name)===t.name);return a&&n.removeStoredMark(a),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}}class z{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=v(I(this,"addOptions",{name:this.name}))),this.storage=v(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new z(e)}configure(e={}){const t=this.extend();return t.options=Te(this.options,e),t.storage=v(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new z(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=v(I(t,"addOptions",{name:t.name})),t.storage=v(I(t,"addStorage",{name:t.name,options:t.options})),t}}function Me(r){return new Vn({find:r.find,handler:({state:e,range:t,match:n})=>{const i=v(r.getAttributes,void 0,n);if(i===!1||i===null)return null;const{tr:s}=e,o=n[n.length-1],l=n[0];let a=t.to;if(o){const c=l.search(/\S/),u=t.from+l.indexOf(o),f=u+o.length;if(Ht(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===r.type&&m!==h.mark.type)).filter(h=>h.to>u).length)return null;f<t.to&&s.delete(f,t.to),u>t.from&&s.delete(t.from+c,u),a=t.from+c+o.length,s.addMark(t.from+c,a,r.type.create(i||{})),s.removeStoredMark(r.type)}}})}z.create({name:"doc",topNode:!0,content:"block+"});z.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:r}){return["p",$(this.options.HTMLAttributes,r),0]},addCommands(){return{setParagraph:()=>({commands:r})=>r.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});z.create({name:"text",group:"inline"});const ri=/^\s*>\s$/;z.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:r}){return["blockquote",$(this.options.HTMLAttributes,r),0]},addCommands(){return{setBlockquote:()=>({commands:r})=>r.wrapIn(this.name),toggleBlockquote:()=>({commands:r})=>r.toggleWrap(this.name),unsetBlockquote:()=>({commands:r})=>r.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Qe({find:ri,type:this.type})]}});const ii=/^\s*([-+*])\s$/;z.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:r}){return["ul",$(this.options.HTMLAttributes,r),0]},addCommands(){return{toggleBulletList:()=>({commands:r})=>r.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[Qe({find:ii,type:this.type})]}});z.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(r=>({tag:`h${r}`,attrs:{level:r}}))},renderHTML({node:r,HTMLAttributes:e}){return[`h${this.options.levels.includes(r.attrs.level)?r.attrs.level:this.options.levels[0]}`,$(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.setNode(this.name,r):!1,toggleHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.toggleNode(this.name,"paragraph",r):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((r,e)=>({...r,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(r=>ni({find:new RegExp(`^(#{1,${r}})\\s$`),type:this.type,getAttributes:{level:r}}))}});z.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:r}){return["hr",$(this.options.HTMLAttributes,r)]},addCommands(){return{setHorizontalRule:()=>({chain:r})=>r().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{var n;if(t){const{$to:i}=e.selection,s=i.end();if(i.nodeAfter)e.setSelection(S.create(e.doc,i.pos));else{const o=(n=i.parent.type.contentMatch.defaultType)===null||n===void 0?void 0:n.create();o&&(e.insert(s,o),e.setSelection(S.create(e.doc,s)))}e.scrollIntoView()}return!0}).run()}},addInputRules(){return[ti({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}});z.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:r}){return["li",$(this.options.HTMLAttributes,r),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}});const si=/^(\d+)\.\s$/;z.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:r=>r.hasAttribute("start")?parseInt(r.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:r}){const{start:e,...t}=r;return e===1?["ol",$(this.options.HTMLAttributes,t),0]:["ol",$(this.options.HTMLAttributes,r),0]},addCommands(){return{toggleOrderedList:()=>({commands:r})=>r.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[Qe({find:si,type:this.type,getAttributes:r=>({start:+r[1]}),joinPredicate:(r,e)=>e.childCount+e.attrs.start===+r[1]})]}});const oi=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,li=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,ai=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,ci=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g;le.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:r=>r.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:r=>/^(bold(er)?|[5-9]\d{2,})$/.test(r)&&null}]},renderHTML({HTMLAttributes:r}){return["strong",$(this.options.HTMLAttributes,r),0]},addCommands(){return{setBold:()=>({commands:r})=>r.setMark(this.name),toggleBold:()=>({commands:r})=>r.toggleMark(this.name),unsetBold:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Se({find:oi,type:this.type}),Se({find:ai,type:this.type})]},addPasteRules(){return[Me({find:li,type:this.type}),Me({find:ci,type:this.type})]}});const ui=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,fi=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,di=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,hi=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g;le.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:r=>r.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:r}){return["em",$(this.options.HTMLAttributes,r),0]},addCommands(){return{setItalic:()=>({commands:r})=>r.setMark(this.name),toggleItalic:()=>({commands:r})=>r.toggleMark(this.name),unsetItalic:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Se({find:ui,type:this.type}),Se({find:di,type:this.type})]},addPasteRules(){return[Me({find:fi,type:this.type}),Me({find:hi,type:this.type})]}});var ve=200,T=function(){};T.prototype.append=function(e){return e.length?(e=T.from(e),!this.length&&e||e.length<ve&&this.leafAppend(e)||this.length<ve&&e.leafPrepend(this)||this.appendInner(e)):this};T.prototype.prepend=function(e){return e.length?T.from(e).append(this):this};T.prototype.appendInner=function(e){return new pi(this,e)};T.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?T.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};T.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};T.prototype.forEach=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)};T.prototype.map=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},t,n),i};T.from=function(e){return e instanceof T?e:e&&e.length?new Wt(e):T.empty};var Wt=function(r){function e(n){r.call(this),this.values=n}r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,l){for(var a=s;a<o;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,l){for(var a=s-1;a>=o;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=ve)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=ve)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(T);T.empty=new Wt([]);var pi=function(r){function e(t,n){r.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(n,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(n,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(n,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(n,Math.min(i,l),s,o)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(n,i):n>=s?this.right.slice(n-s,i-s):this.left.slice(n,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e}(T),Vt=T;const mi=500;class B{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let i,s;t&&(i=this.remapping(n,this.items.length),s=i.maps.length);let o=e.tr,l,a,c=[],u=[];return this.items.forEach((f,d)=>{if(!f.step){i||(i=this.remapping(n,d+1),s=i.maps.length),s--,u.push(f);return}if(i){u.push(new F(f.map));let h=f.step.map(i.slice(s)),p;h&&o.maybeStep(h).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new F(p,void 0,void 0,c.length+u.length))),s--,p&&i.appendMap(p,s)}else o.maybeStep(f.step);if(f.selection)return l=i?f.selection.map(i.slice(s)):f.selection,a=new B(this.items.slice(0,n).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:l}}addTransform(e,t,n,i){let s=[],o=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let u=0;u<e.steps.length;u++){let f=e.steps[u].invert(e.docs[u]),d=new F(e.mapping.maps[u],f,t),h;(h=a&&a.merge(d))&&(d=h,u?s.pop():l=l.slice(0,l.length-1)),s.push(d),t&&(o++,t=void 0),i||(a=d)}let c=o-n.depth;return c>yi&&(l=gi(l,c),o-=c),new B(l.append(s),o)}remapping(e,t){let n=new re;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,o)},e,t),n}addMaps(e){return this.eventCount==0?this:new B(this.items.append(e.map(t=>new F(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-t),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(d=>{d.selection&&l--},i);let a=t;this.items.forEach(d=>{let h=s.getMirror(--a);if(h==null)return;o=Math.min(o,h);let p=s.maps[h];if(d.step){let m=e.steps[h].invert(e.docs[h]),w=d.selection&&d.selection.map(s.slice(a+1,h));w&&l++,n.push(new F(p,m,w))}else n.push(new F(p))},i);let c=[];for(let d=t;d<o;d++)c.push(new F(s.maps[d]));let u=this.items.slice(0,i).append(c).append(n),f=new B(u,l);return f.emptyItemCount()>mi&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)i.push(o),o.selection&&s++;else if(o.step){let a=o.step.map(t.slice(n)),c=a&&a.getMap();if(n--,c&&t.appendMap(c,n),a){let u=o.selection&&o.selection.map(t.slice(n));u&&s++;let f=new F(c.invert(),a,u),d,h=i.length-1;(d=i.length&&i[h].merge(f))?i[h]=d:i.push(f)}}else o.map&&n--},this.items.length,0),new B(Vt.from(i.reverse()),s)}}B.empty=new B(Vt.empty,0);function gi(r,e){let t;return r.forEach((n,i)=>{if(n.selection&&e--==0)return t=i,!1}),r.slice(t)}class F{constructor(e,t,n,i){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new F(t.getMap().invert(),t,this.selection)}}}class D{constructor(e,t,n,i){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=i}}const yi=20;function wi(r,e,t,n){let i=t.getMeta(J),s;if(i)return i.historyState;t.getMeta(xi)&&(r=new D(r.done,r.undone,null,0));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return r;if(o&&o.getMeta(J))return o.getMeta(J).redo?new D(r.done.addTransform(t,void 0,n,me(e)),r.undone,mt(t.mapping.maps[t.steps.length-1]),r.prevTime):new D(r.done,r.undone.addTransform(t,void 0,n,me(e)),null,r.prevTime);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=r.prevTime==0||!o&&(r.prevTime<(t.time||0)-n.newGroupDelay||!ki(t,r.prevRanges)),a=o?Fe(r.prevRanges,t.mapping):mt(t.mapping.maps[t.steps.length-1]);return new D(r.done.addTransform(t,l?e.selection.getBookmark():void 0,n,me(e)),B.empty,a,t.time)}else return(s=t.getMeta("rebased"))?new D(r.done.rebased(t,s),r.undone.rebased(t,s),Fe(r.prevRanges,t.mapping),r.prevTime):new D(r.done.addMaps(t.mapping.maps),r.undone.addMaps(t.mapping.maps),Fe(r.prevRanges,t.mapping),r.prevTime)}function ki(r,e){if(!e)return!1;if(!r.docChanged)return!0;let t=!1;return r.mapping.maps[0].forEach((n,i)=>{for(let s=0;s<e.length;s+=2)n<=e[s+1]&&i>=e[s]&&(t=!0)}),t}function mt(r){let e=[];return r.forEach((t,n,i,s)=>e.push(i,s)),e}function Fe(r,e){if(!r)return null;let t=[];for(let n=0;n<r.length;n+=2){let i=e.map(r[n],1),s=e.map(r[n+1],-1);i<=s&&t.push(i,s)}return t}function jt(r,e,t,n){let i=me(e),s=J.get(e).spec.config,o=(n?r.undone:r.done).popEvent(e,i);if(!o)return;let l=o.selection.resolve(o.transform.doc),a=(n?r.done:r.undone).addTransform(o.transform,e.selection.getBookmark(),s,i),c=new D(n?a:o.remaining,n?o.remaining:a,null,0);t(o.transform.setSelection(l).setMeta(J,{redo:n,historyState:c}).scrollIntoView())}let Le=!1,gt=null;function me(r){let e=r.plugins;if(gt!=e){Le=!1,gt=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Le=!0;break}}return Le}const J=new q("history"),xi=new q("closeHistory");function Si(r={}){return r={depth:r.depth||100,newGroupDelay:r.newGroupDelay||500},new Y({key:J,state:{init(){return new D(B.empty,B.empty,null,0)},apply(e,t,n){return wi(t,n,e,r)}},config:r,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,i=n=="historyUndo"?Kt:n=="historyRedo"?qt:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}const Kt=(r,e)=>{let t=J.getState(r);return!t||t.done.eventCount==0?!1:(e&&jt(t,r,e,!1),!0)},qt=(r,e)=>{let t=J.getState(r);return!t||t.undone.eventCount==0?!1:(e&&jt(t,r,e,!0),!0)};P.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:r,dispatch:e})=>Kt(r,e),redo:()=>({state:r,dispatch:e})=>qt(r,e)}},addProseMirrorPlugins(){return[Si(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}});P.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:r=>r.style.textAlign||this.options.defaultAlignment,renderHTML:r=>r.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${r.textAlign}`}}}}]},addCommands(){return{setTextAlign:r=>({commands:e})=>this.options.alignments.includes(r)?this.options.types.every(t=>e.updateAttributes(t,{textAlign:r})):!1,unsetTextAlign:()=>({commands:r})=>this.options.types.every(e=>r.resetAttributes(e,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});const Mi={class:"card card-default"},vi=$e("div",{class:"card-header"},[$e("h5",{class:"card-title"},"Descri\xE7\xE3o")],-1),bi={class:"card-body p-0"},Ti={__name:"Descricao",setup(r){let e="<p>teste <strong>bold</strong></p>";return(t,n)=>{const i=Ut("Editor");return _t(),Zt("div",Mi,[vi,$e("div",bi,[Qt(i,{conteudo:Xt(e)},null,8,["conteudo"])])])}}};export{Ti as default};
